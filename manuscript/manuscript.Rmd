---
title: The dynamics of risk perception in a Mediterranean agroecosystem
subtitle: 
titlerunning: The dynamics of risk perception in a Mediterranean agroecosystem
authorrunning: Gauthier
thanks: | 
    Grants or other notes about the article that should go on the front 
    page should be placed here. General acknowledgments should be placed at the
    end of the article.

authors: 
- name: Nicolas Gauthier 1
  address: Laboratory of Tree-Ring Research & School of Geography and Development, University of Arizona
  email: ngauthier@email.arizona.edu
  

keywords:
- key
- dictionary
- word

#PACS: 
#- PAC1
#- superPAC
    
MSC:
- MSC code 1
- MSC code 2

abstract: |
  Small-scale agriculturalists in the Mediterranean Basin rely on multiple strategies including diversification, intensification, and storage to maintain a stable food supply in the face of environmental uncertainty. Each of these strategies requires farmers to make specific resource allocation decisions in response to environmental risks and is thus sensitive to variability in both the spatiotemporal pattern of risk and the ability of farmers to perceive that pattern. In this chapter, I present an agent-based model of a Mediterranean agroecosystem. By driving the model with realistic environmental dynamics derived from simulations of mid-Holocene Mediterranean climate, and by allowing the psychology of risk perception to vary among individual farmers, I explore the hidden vulnerabilities of traditional risk-management strategies to periods of rapid climate change. I show that even when farmers are able to manage risk “optimally” in light of past experience, unanticipated changes in the spatiotemporal pattern of rainfall can still lead to major food shortfalls.

bibliography: bibliography.bib
bibstyle: spbasic
# bibstyle options spbasic(default), spphys, spmpsci
output: rticles::springer_article
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(raster)
library(tidyverse)
```

```{r}
set.seed(1111)
```

# Introduction {#intro}

Over the past 10,000 years, subsistence farmers in the Mediterranean basin have developed sophisticated strategies to maintain stable food supplies given uncertain rainfall. Their suite of strategies include practices like crop diversification, storage, and exchange [@Halstead1989]). These risk-management strategies all represent forms of \emph{regulatory feedback} used to manage complex socio-ecological systems. Regulatory feedbacks convert a system's high-variance inputs into low-variance outputs by dynamically monitoring the outputs and adjusting internal properties of the system [@Anderies2015]. Risk-managing strategies require farmers to make specific resource allocation decisions in response to environmental risks, and as regulatory feedbacks they are thus sensitive to variability in both the spatiotemporal patterns of risk and the ability of farmers to perceive and act on those patterns.

Crop diversification is an excellent example of a widespread and effective regulatory feedback strategy (Figure 1). Relying on a mix of food types with different climatic tolerances is an efficient way to maintain a robust food supply [@helmers2001separating,Anderies2006]. In the Mediterranean, land-use strategies involving a diversified portfolio of wheat and barley have been employed by even the earliest sedentary farmers, and continue to be used to this day [@GOULD1963a,Slafer1999,Abbo2009a,Marston2011190]. Wheat generally has higher yields but is sensitive to water deficits, while barley has lower yields and is drought tolerant. Planting a mix of wheat and barley, either in the same plot or in a combination of plots, is an effective means of diversifying grain supplies. By adjusting the ratio of wheat to barley, farmers can adapt to changing drought risks.

The secret to the success of earliest farmers on the mediterrenan littoral was in their manipulation of the local ecosystem to manage environmental risks. Early farmers constructed a complex agroecosystem to manage risk.
They needed to maintain stable crop yields in face of uncertain drought risks. Yield stability is very important for traditional agriculturlal commmunities not connected to larger bulk food networks (Abbo et al 2010)
neolithic crop package -- weiss zohary 2011
cite abbo et al 2010? for more stuff about ladraces
Wheat/barley systems
example of system that combines low yield, low wirks crop with high yield high risk crop, an effective context paut et al 2019
These strategies work when risks are knonw and constant, but may be more susceptible to periods of changing climateic risks
so understanding how people of the past adapted to change is important to us today

Are these crop-diversification strategies vulnerable to the same dynamics as other social-ecological systems with similar regulatory feedbacks mechanisms? One way to address this is to model the influence of imperfect monitoring and biased decision making in uncertain environments. In this study, I accomplish this by answering two main questions:

1. What was the temporal pattern of climate and climate change during the Holocene in the eastern Mediterranean?
2. How well could crop diversification strategies cope with this pattern, given farmers’ imperfect risk perception and decision-making?


Questions:
How would the earliest farmers have made decisions (dealt with uncertainty?) about crop diversification?
ie what were the different algorithms? -- better understand the decision context
What are the consequences of theses different decisions (i.e. how well did they perform) at different points in the history of the mediterranean
How were farmers able to detect changes in the environment, rather than unconsciously adapt to them?
what are the different consequences we'd expect for each
THIS is the most important question because with it I can frame the results around and individual's perception of droughts in the neolithic, and the populaiton-level distribution of drought perceptions at given times

I couple a climate model with high temporal resolution to a simple game theoretic model of agricultural decision making under uncertainty, in order to examine the performance of optimal and suboptimal wheat-barley diversification practices. I model the year-to-year crop diversification strategies made by farmers as an iterated game of fictitious play against nature [@GOULD1963a]. Farmers are boundedly rational, in that they seek to maximize their objective functions given the perceived probabilities of different actions by nature, but work with flawed mental models of climate-related risks due to imperfect recall of past events. Furthermore, by using a climate model to represent the actions of nature, I can more precisely capture the characteristic autocorrelated patterns of rainfall variability, rather than simply drawing rainfall values from a static distribution. This framework allows me to address the sensitivity of diversification strategies to changes and climatic variability and imperfect human perceptions of those changes.

# Decision-making in a game against nature {#sec:1}

The basic decision-making problem facing a farmer seeking to diversify their crops can be thought of as a game against nature.
We can represent this simplified decision context as a "game" in a game theorietic context.
cite luce raiffa 1989 for game against nature, and milnor 1952, Agrawal1968, cassidy1971, gould 1963
The "game" in this context is the farmer's decision of which crops to plant and in what proportions, given uncertianty in the future "state-of-nature", and nature varies between several possible states such as dry and wet years.
payoff matrix goes here
in reality continuous, but cite behavioral econ for people often intuitively solve an easier problem when faced with a complex real-world situation
The exact values in the payoff matrix here are less important than the relative payoffs in each quadrant.
We can think of this game as being the culturally-inherited object. our question is how do individuals make decisions here?
so in this case the cultural norm would be to mix wheat and barley, but the learning is in the exact ratio -- both individual and social learning influence perceptions of eindividual vs social learning tucker 2007

Estimates of yield volume (t/ha) for each crop type in wet and dry years were derived from isotopic studies of ancient wheat and barley samples from archaeological sites in the Mediterranean [@Slafer1999] (Table 1). 


\begin{table}
\centering
\caption{Estimated yields for ancient wheat and barley varieties derived from [@Slafer1999].}
\begin{tabular}{|l|l|l|}
\hline

 & Dry Year & Normal Year \\ \hline
Barley Yield & 0.93 & 1.18 \\ \hline
Wheat Yield & 0 & 1.60 \\ \hline

\end{tabular}
\end{table}


```{r}
wheat_dry <- 0
wheat_normal <- 1.6

barley_dry <- 0.93
barley_normal <- 1.18
```

How should an early farmer make a decision in light ot this uncertainty?
The basic logic of crop diversitication is Portfolio of crops ala modern portfolio theory: Blank2001
Sometimes best to think of nature as a sentient opponent out to get you, and play strategically based on that assumption. Gould 1963,  Beckenkamp 2008
quick overview of criteria without risk, then say that a better option is to estimate the probabilities of the different state of nature
Agrawal1968 talks about the strategies in the context of agriculture being a game against nature
here I can slip in the cool thing about acting like the weather is out to get you being a good idea in states of complete uncertainty
transition -- the problem becomes easier if you have at least someI idea of nature's moves , because then you cna work to get the highest yeilds given the risk of drought
Decision strategies as choosing different points -- plot of decisions

\begin{align}
a^2+b^2=c^2
\end{align}


```{r}
expected_yield_wheat <- function(risk) {
  risk * wheat_dry + (1 - risk) * wheat_normal
}

expected_yield_barley <- function(risk) {
  risk * barley_dry + (1 - risk) * barley_normal
}

expected_yield <- function(risk) {
  expected_yield_wheat(risk) + expected_yield_barley(risk)
}
```

```{r, echo = FALSE, fig.cap = 'Expected wheat and barley yields under increasing drought risk with the point of indifference highlighted.'}
indiff <- tibble(risk = (barley_normal - wheat_normal) / (wheat_dry - wheat_normal - barley_dry + barley_normal),
                 yield = risk * wheat_dry + (1 - risk) * wheat_normal)
indiff_label <- paste0('(', round(indiff$risk, 2), ', ', round(indiff$yield, 2), ')')

tibble(risk = seq(0, 1, .1),
      Barley = expected_yield_barley(risk),
      Wheat = expected_yield_wheat(risk)) %>%
  gather(type, yield, Barley:Wheat) %>%
  ggplot(aes(risk, yield)) +
  geom_hline(yintercept = indiff$yield, linetype = 2)+
  geom_vline(xintercept = indiff$risk, linetype = 2) +
  geom_line(aes(color = type), size = 1.2) +
  geom_point(data = indiff, color = 'black', size = 3) +
  geom_text(data = indiff, label = indiff_label, nudge_x = 0.1, nudge_y = 0.1) +
  theme_classic() +
  scale_color_discrete(name = 'Crop') +
  labs(x = 'Drought probability', y = 'Expected yield')
```

If an individual can learn about their environment, such as the risk of drought in any given year, then they can behave more rationally by trying to maximize their subjective expected utility
If the probability distributin of nature's moves is known, the farmer can choose the crop mix that simply maximizes the expected crop yields given the empirical frequency distirubtion of nature's moves.
In the language of game theory, this strategy is knoan as a "game of ficticious play" against nature.
This is an effective risk-managing strategy, but like all similar strategies that adapt to a specific pattern of variability, it is vulnerable to changes in the pattern of variability (Janssen eta al 2007)
This strategy works well when the environment is stationary -- nature plays from a fixed probability distirubtion, but is vulnerable to environmental nonstationarity.
That is, when the mean or higher order moments of the rainfall distribution shift, playing a game of fictitious play can backfire because you're too stuck in your ways while the world changes around you.
Thus it is important to understand the dynamics of risk perception -- how subjective risks, and thus subjective expected utility -- rise and fall in uncertain environments.


# The dynamics of risk perception {#sec:2}

```{r}
prior <- function(m, n) {
  domain <- seq(0,1,0.005)
  val <- dbeta(domain, n * m, n * (1 - m))
  tibble('x' = domain, 'y' = val)
}

tibble(year = seq(5, 50, 5),
       risk = .5) %>%
  mutate(belief = map2(risk, year, ~prior(.x, .y))) %>%
  unnest(cols = c(belief)) %>%
  ggplot(aes(x, y)) +
  geom_line(aes(group = year, color = year), size = 1.2) +
  scale_color_viridis_c() +
  theme_bw() +
  ggtitle('Subjective beliefs about drought risk', 'Beta prior, varying sample size')

tibble(year = 50,
       risk = seq(.1,.9, .1)) %>%
  mutate(belief = map2(risk, year, ~prior(.x, .y))) %>%
  unnest(cols = c(belief)) %>%
  ggplot(aes(x, y)) +
  geom_line(aes(group = risk, color = risk), size = 1.2) +
  scale_color_viridis_c() +
  theme_bw() +
  ggtitle('Subjective beliefs about drought risk', 'Beta prior, varying sample size')
```

# Drought risks in the middle Holocene

# Climate Risks and Risk Perception

Using the bias-corrected climate model output, I divided each model year into dry years and wet years. A dry year was any year where less than 300mm of rain fell during the wet season (October-March), the threshold below which wheat crops will generally fail [@Wilkinson1997], and a wet/normal year was defined as any year above this threshold. 

Given the modeled patterns of wet and dry years, drought risk for any particular year was defined as the proportion of the previous 50 years that were dry years

\begin{equation}
    P_{dry} = \frac{\sum_{n=t-1}^{t-50} precip_n < 300}{50},
\end{equation} 
where $t$ is the current time step. The 50 year time span was selected to approximate the accumulated observational knowledge of an individual farmer and their immediate household. As a result, this approach does not allow for accumulated social learning, although it could easily be extended to do so in future studies.

## Climate Modeling and Bias Correction

Estimates of drought risk in the eastern Mediterranean during the the past 10,000 years were derived from outputs of the TraCE-21k paleoclimate simulation available on the National Center for Atmospheric Research's Earth System Grid repository (https://www.earthsystemgrid.org). TraCE-21K is a state-of-the-art simulation that uses a coupled atmosphere-ocean general circulation model (GCM) to recreate the transient response of the global climate system to orbital parameters and greenhouse gasses over the past 22,000 years from the Last Glacial Maximum to the present (Figure 2) [@He2011]. It generates physically consistent spatiotemporal climate dynamics, driven by current best estimates of climate forcings (e.g. orbit, greenhouse gasses, glacial meltwater flux). The model simulates these dynamics on a six hourly timescale, and model outputs are archived at a monthly resolution.

TraCE-21k simulation outputs for the past 10,000 years were bias-corrected using the CDF-t method and observed precipitation from a weather station in near the town of Salihli in western Turkey. This location was selected due to its long (~70yr) observational record, the representativeness of western Anatolian climate for the greater eastern Mediterranean, and its proximity to archaeological sites with comparative evidence of crop diversification strategies.


Now incorporate realistic drought variability from simulations.


```{r}
konya <- matrix(c(32.5, 37.9), nrow = 1)
#konya <- matrix(c(33.5138, 36.2765), nrow = 1)
```

```{r, cache = TRUE}
precc <- map(list.files('../Data/PRECC', full.names = TRUE)[-12],
             ~brick(.) %>%
               raster::extract(konya, df = TRUE) %>%
  select(-ID) %>%
  gather(time, precc) ) %>%
  bind_rows()
precl <- map(list.files('../Data/PRECL', full.names = TRUE)[-12],
             ~brick(.) %>%
               raster::extract(konya, df = TRUE) %>%
  select(-ID) %>%
  gather(time, precl) ) %>%
  bind_rows()

sim_past <- left_join(precc, precl, by = 'time') %>%
  mutate(rainfall = (precc + precl) * 2.628e+9,
         year = rep(-10200:-5001, each = 12), # add hardcode dates instead of using ncdf time because of date shift with averaging period
         month = rep(1:12, times = 5200)) %>%
  select(-time, -precl, -precc) %>%
  mutate(water_year = if_else(month %in% 10:12, year + 1L, year)) %>% 
   filter(!(month %in% c(6:9))) %>%
  group_by(water_year) %>%
  add_tally() %>%
  filter(n == 8) %>%
  summarise(precip = sum(rainfall)) %>%
  mutate(drought = precip < 300)
```


```{r, fig.height =2, fig.width = 6, fig.cap = 'Annual risk of wheat crop failure due to drought, averaged by fifty-year period'}
sim_past %>%
  filter(between(water_year, -9500, -5500)) %>%
  mutate(time_step = ceiling(water_year / 50),
         year = time_step * 50) %>%
  group_by(year) %>%
  summarise(risk = sum(drought) / 50) %>%
  ggplot(aes(year, risk, fill = risk, color = risk)) +
  geom_hline(yintercept = indiff$risk, color = 'black', linetype = 2, size = 1) +
  geom_col()  +
  scale_fill_distiller(palette = 'YlOrRd', direction = 1) +
  scale_color_distiller(palette = 'YlOrRd', direction = 1)+
  theme_minimal() +
  labs(x = 'Years BP', y = 'Drought risk')  + theme(legend.position = "none")
```


# The Model
```{r}
agents <- tibble(id = 1:150, 
                 alpha = 1.5,
                 beta = 1.5,
                 risk = alpha / (alpha + beta),
                 age = sample.int(80, size = 150, replace = TRUE),
                 crop = 'barley')
```


```{r}
learn1 <- function(agents, drought) {
  if (drought == 'TRUE') wheat_yield <- wheat_dry; barley_yield <- barley_dry
  if (drought == 'FALSE') wheat_yield <- wheat_normal; barley_yield <- barley_normal

  agents %>%
    # farmer's turn to decide what to plant
      mutate(yield_exp = expected_yield(risk),
         barley_exp = expected_yield_barley(risk),
         wheat_exp = expected_yield_wheat(risk),
         expected_yield = barley_exp + wheat_exp,
         crop = case_when(barley_exp > wheat_exp ~ 'barley',
                              barley_exp < wheat_exp ~ 'wheat',
                              barley_exp == wheat_exp ~ 'either'),
         prediction = map2(alpha, beta, ~rbeta(100, .x, .y)), # sample 100 as if agent is thinking in percentages
         wheat_prop = map_dbl(prediction, ~sum(. < indiff$risk)) / 100) %>%
      select(-prediction) %>%
  # nature's turn to decide realized yields
    mutate(payoff = wheat_yield * wheat_prop + barley_yield * (1 - wheat_prop),
           alpha = drought + alpha,
           beta = beta + 1 - drought,
          # mu = alpha / (alpha + beta),
           risk = map2_dbl(alpha, beta, ~rbeta(1, .x, .y)))
}

learn2 <- function(agents, drought) {
  if (drought == 'TRUE') wheat_yield <- wheat_dry; barley_yield <- barley_dry
  if (drought == 'FALSE') wheat_yield <- wheat_normal; barley_yield <- barley_normal

  agents %>%
    # farmer's turn to decide what to plant
      mutate(yield_exp = expected_yield(risk),
         barley_exp = expected_yield_barley(risk),
         wheat_exp = expected_yield_wheat(risk),
         expected_yield = barley_exp + wheat_exp,
         crop = case_when(barley_exp > wheat_exp ~ 'barley',
                              barley_exp < wheat_exp ~ 'wheat',
                              barley_exp == wheat_exp ~ 'either'),
         prediction = map2(alpha, beta, ~rbeta(100, .x, .y)), # sample 100 as if agent is thinking in percentages
         wheat_prop = map_dbl(prediction, ~sum(. < indiff$risk)) / 100) %>%
      select(-prediction) %>%
  # nature's turn to decide realized yields
    mutate(payoff = wheat_yield * wheat_prop + barley_yield * (1 - wheat_prop),
           alpha = if_else(payoff < .5, 1, drought + alpha),
           beta = if_else(payoff < .5, 1, beta + 1 - drought),
          # mu = alpha / (alpha + beta),
           risk = map2_dbl(alpha, beta, ~rbeta(1, .x, .y)))
}

# or keep risk parameter constant and reduce the effective sample size, in other words keep the ratio of alpha to beta but decrease the absoulte value
```


Run an experiment. Simulate a time series with varying drought frequency. This is a stepwise nonstationary process
```{r}
droughts <- c((runif(25) < .1),(runif(25) < .5), runif(50) < .2)
```

```{r}
prior2 <- function(a, b) {
  domain <- seq(0,1,0.005)
  val <- dbeta(domain, a, b)
  tibble('x' = domain, 'y' = val)
}

accumulate(droughts, 
           ~mutate(.x, alpha = .y + alpha, beta = beta + 1 - .y), 
           .init = tibble(alpha = 1.5, beta = 1.5)) %>%
  bind_rows(.id = 'time') %>%
    mutate(time = as.numeric(time), belief = map2(alpha, beta, ~prior2(.x, .y))) %>%
  unnest(cols = c(belief)) %>%
  ggplot(aes(x, y)) +
  geom_line(aes(color = time, group = time), size = .8) +
    geom_vline(xintercept = c(0.1, 0.5, 0.2), linetype = 2, color = 'red', size = .8) +
  scale_color_viridis_c() +
  theme_bw() +
  ggtitle('Subjective beliefs about drought risk', 'Beta prior, varying sample size')
```

```{r}
simulation1 <- accumulate(droughts, ~learn1(.x, .y), .init = agents) %>% 
  bind_rows(.id = 'time') %>%
  mutate(time = as.numeric(time)) %>%
  filter(time != 1)

simulation2 <- accumulate(droughts, ~learn2(.x, .y), .init = agents) %>% 
  bind_rows(.id = 'time') %>%
  mutate(time = as.numeric(time)) %>%
  filter(time != 1)
```

Redo these plots so its a single person, one who was born in a drought period then experiences an ameliorarion and another who experiences a shift to drought conditions later in life? basically this section neds to work more with individuals and explore that stuff

```{r}
test1 <- tibble(time = 1:100,
       risk = c(rep(0.1, 25), rep(0.5, 25), rep(0.2, 50)))

ggplot(simulation1, aes(time, risk)) +
  geom_line(data = test1) +
  geom_point(alpha = .1) +
  geom_hline(yintercept = indiff$risk, color = 'red', linetype = 2) +
  theme_classic()
```

```{r}
ggplot(simulation2, aes(time, risk)) +
  geom_line(data = test1) +
  geom_point(alpha = .1) +
  geom_hline(yintercept = indiff$risk, color = 'red', linetype = 2) +
  theme_classic()

```

```{r}
ggplot(simulation2, aes(time, risk)) +
  geom_point(alpha = .1) +
  geom_hline(yintercept = indiff$risk, color = 'red', linetype = 2) +
  theme_classic()
```

```{r}
simulation1 %>%
  group_by(time, crop) %>%
  tally() %>%
ggplot(aes(time, n, fill = crop)) +
  geom_bar(width = 1, stat = 'identity', position = 'fill') +
  scale_fill_manual(values = c('darkgoldenrod', 'lightgoldenrod')) +
  theme_classic()
```

```{r}
simulation2 %>%
  group_by(time, crop) %>%
  tally() %>%
ggplot(aes(time, n, fill = crop)) +
  geom_bar(width = 1, stat = 'identity', position = 'fill') +
  scale_fill_manual(values = c('darkgoldenrod', 'lightgoldenrod')) +
  theme_classic()
```

These two plots begin to look more alike the more you sample, which makes sense because its an ergodic system.

Note in these plots above and below we're summing all the wheat and barley in the population, compared to below which shows the wheat proportions of individuals
```{r}
ggplot(simulation1, aes(time, wheat_prop)) +
  geom_point(alpha = .3) +
  theme_classic()

ggplot(simulation2, aes(time, wheat_prop)) +
  geom_point(alpha = .3) +
  theme_classic()
```

```{r}
simulation1 %>%
  group_by(time) %>%
  summarise(famine = sum(payoff == 0)) %>%
ggplot(aes(time, famine)) +
  geom_line() +
  theme_classic()
simulation2 %>%
  group_by(time) %>%
  summarise(famine = sum(payoff == 0, na.rm = TRUE)) %>%
ggplot(aes(time, famine)) +
  geom_line() +
  theme_classic()
```

```{r}
simulation1 %>%
  group_by(time) %>%
  summarise(payoff = mean(payoff)) %>%
ggplot(aes(time,payoff)) +
  geom_point(aes(color = time)) +
  theme_classic()

simulation2 %>%
  group_by(time) %>%
  summarise(payoff = mean(payoff, na.rm = TRUE)) %>%
ggplot(aes(time,payoff)) +
  geom_point(aes(color = time)) +
  theme_classic()
```

```{r}
library(ggridges)
simulation1 %>%
  mutate(time_step = 5 * round(time/5),
         famine = payoff == 0) %>%
  ggplot(aes(wheat_prop, as.factor(time_step))) +
  geom_density_ridges(rel_min_height = 0.005) +
  theme_ridges()

simulation2 %>%
  mutate(time_step = 5 * round(time/5),
         famine = payoff == 0) %>%
  ggplot(aes(wheat_prop, as.factor(time_step))) +
  geom_density_ridges(rel_min_height = 0.005) +
  theme_ridges()
```





make this a function to calculate payoffs for all wheat or all barley strategies as a comparison
```{r}
tibble(drought = droughts,
       barley = if_else(droughts == FALSE, barley_normal, barley_dry),
       wheat = if_else(droughts == FALSE, wheat_normal, wheat_dry),
       equal = (barley + wheat) / 2) %>%
  mutate(time = 1:n()) %>%
  gather(crop, yield, barley:equal) %>%
  ggplot(aes(time, yield, group = crop, color = crop)) +
  geom_point()
```

```{r}
tibble(drought = droughts,
       barley = if_else(droughts == FALSE, barley_normal, barley_dry),
       wheat = if_else(droughts == FALSE, wheat_normal, wheat_dry),
       equal = (barley + wheat) / 2) %>%
  mutate(time = 1:n()) %>%
  gather(crop, yield, barley:equal) %>%
  mutate(famine = yield == 0) %>%
  ggplot(aes(time, famine, group = crop, color = crop)) +
  geom_line()
```


\section{Results and Discussion}


The bias-corrected wet season precipitation outputs from TraCE-21k show a relatively stationary distribution over the past 10,000 years, with slightly drier conditions during the early-mid Holocene transition at c.a. 8ka BP (Figure 5). The utility of a diversified wheat-barley crop is immediately apparent; rainfall often fails to meet the 300mm threshold for a productive wheat crop during the entire 10,000 year span, but drops below the threshold for barley only a handful of years.

The risk of crop failure due to drought in any given year varies between 10\% and 20\%, punctuated by one to four century-long events where risk drops as low as 6\% and or exceeds 25\% (Figure 6). Centuries of high drought risk cluster around known periods of regional and global climate deterioration, such as at 8.6ka BP and 4.2ka BP.

Given the average drought risks estimated from TraCE-21k and assuming perfect monitoring and recall of recent droughts (i.e. $\lambda = 0$), farmers intent on minimizing the risk of crop failure would be expected to plant about 65\% barley to 35\% wheat on average. This proportion is within the range estimated from macrobotanical remains at a nearby archaeological site [@Marston2011190]. Yield maximizing farmers instead play a pure strategy profile, planting wheat if the perceived drought risk is less than 0.68 and barley if it is more. Because the GCM-simulated drought risk never rises above this threshold, a yield-maximizing farmer will always plant a wheat monocrop.


Examining the long-term dynamics of crop yields among all decision-making strategies and psychological profiles reveals variability in yields due to different decision making preferences is far greater variability due to differences in risk perception (Figure 7). Risk-minimizing strategies sacrifice productivity for predictability, consistently lowering the mean and variance of crop yields over time. Risk-minimizing strategies are more sensitive to risk perception than yield-maximizing strategies; varying the memory decay rate parameter $\lambda$ had no effect on the optimal crop allocation for yield maximizers. 

During periods of climatic stability, allowing past experiences to influence decision making helps farmers minimize the impacts of \emph{predictable} drought. But past experiences are less informative during periods of rapid climate change, and even farmers who manage risk “optimally” experience major food shortfalls. Climatically-induced variability in food supplies consistently surpasses that from differences in risk-perception psychology, but not that from different risk aversion preferences. This finding suggests that the efficacy of risk managing strategies that rely on regulatory feedbacks is limited to periods of relative climatic stability. This is consistent with the observation from the Roman Period Mediterranean that while minor food crises were common in the ancient world, extreme famines were rare [@Garnsey1989].

Statistically downscaling palaeoclimate simulations and coupling them to game theoretic models of decision making under uncertainty is a simple way to better understand the patterning of climate changes and the regulatory feedbacks farmers use to adapt to them. To further explore these patterns, future work should incorporate additional risk-minimizing strategies such as storage and exchange. Food storage and exchange can also be thought of as forms of diversification, the former in the time and the latter in space [@Marston2011190]. Food exchange would be of particular interest from a game theoretic perspective, as incomplete information with respect to an exchange partner's crop diversification and storage practices can lead to situations of moral hazard.


Think about the importance of the population's age structure, becuase that's going to impact the collective memory of drought.



# References

